<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Boioyala | {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      
.header-main {
    position: relative;
    padding-top: 7px;
    padding-bottom: 7px;
    background-color: #ffffff
}
.show_{
    display: block !important;
}
.logo {
    color: black;
    font-size: 25px;
    font-weight: 600
}

.brand-wrap {
    text-decoration: none !important
}

.icon-sm {
    width: 48px;
    height: 48px;
    line-height: 48px !important;
    font-size: 20px
}

.widget-header {
    display: inline-block;
    vertical-align: middle;
    position: relative
}

.widget-header .notify {
    position: absolute;
    top: -3px;
    right: -10px
}

.notify {
    position: absolute;
    top: -4px;
    right: -10px;
    display: inline-block;
    padding: .25em .6em;
    font-size: 12px;
    line-height: 1;
    text-align: center;
    border-radius: 3rem;
    color: #fff;
    
}

.mr-3,
.mx-3 {
    margin-right: 1rem !important
}

.search-form {
    border: 1px solid #020101 !important
}

.search-button {
    color: white;
    background-color: green;
    border-color: black
}

.navbar-main {
    background-color: #fff
}

.navbar-toggler {
    color: rgba(0, 0, 0, 0.5);
    color: rgba(0, 0, 0, 0.5);
    border-color: rgba(0, 0, 0, 0.1) !important
}

.navbar-toggler {
    padding: 4px;
    font-size: 1.25rem;
    line-height: 1;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 0.37rem
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 10rem;
    padding: .5rem 0;
    margin: .5rem 7px 0px;
    font-size: 1rem;
    color: #212529;
    text-align: left;
    list-style: none;
    background-color: #fff;
    background-clip: padding-box;
    border: 1px solid rgba(0, 0, 0, .15);
    border-radius: .25rem
}

.dropdown-item {
    display: block;
    width: 100%;
    padding: .45rem 1.5rem;
    clear: both;
    font-weight: 400;
    color: #212529;
    text-align: inherit;
    white-space: nowrap;
    background-color: transparent;
    border: 0
}

.navbar-toggler-icon {
    background-image: url(https://img.icons8.com/ios/50/000000/menu.png)
}

.nav-link {
    text-transform: uppercase;
    font-weight: 400
}

.vl {
    border-left: 1px solid #fff;
    height: 100%
}

.fas {
    color: #fff
}

.login {
    color: white;
    background:green;
    padding:6px 7px;
    border-radius: 3px;
    
}
    </style>
  </head>
  <body style="overflow-x: hidden;background: #f8f9fa !important;">
     {% include 'header.html' %}
   
     <main>
            {% block content %}
            {% endblock %}
       
     </main>

<!-- Button trigger modal -->

{% if request.user.is_authenticated %}
<!-- Modal -->
<div class="modal fade" id="donateModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Donate Book</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="modal-body">
          <form action="{% url 'create_book' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
                  <input type="text" class="form-control" name="name" placeholder="Book Title" required="">
              </div>

              <div class="form-row">
                  <div class="form-group col-8">
                      <input type="text" class="form-control" name="author" placeholder="Author Name" required="">
                  </div>
                  <div class="form-group col-4">
                      <input type="number" class="form-control" name="quantity" placeholder="Copies" required="">
                  </div>
              </div>

              <div class="form-row">
                  <div class="form-group col-6">
                      <select name="categories" class="custom-select" required="">
                          <option selected="" disabled="">Select Categories</option>
                          {% for obj in category_objs %}
                            <option value="{{obj.id}}">{{obj.name}}</option>
                            {% endfor %}
                            
                    </select>
                  </div>

                  <div class="form-group custom-file col-6">
                      <input type="file" class="custom-file-input" name="cover" required="">
                      <label class="custom-file-label" for="">Select Cover</label>
                  </div>
                  <div class="form-group col-6">
                    <select name="district" id="district" class="custom-select district" required="">
                        <option selected disabled>Select District</option>    
                           
                        <option value="Comilla">Comilla</option>
                     
                        <option value="Feni">Feni</option>
                     
                        <option value="Brahmanbaria">Brahmanbaria</option>
                     
                        <option value="Rangamati">Rangamati</option>
                     
                        <option value="Noakhali">Noakhali</option>
                     
                        <option value="Chandpur">Chandpur</option>
                     
                        <option value="Lakshmipur">Lakshmipur</option>
                     
                        <option value="Chattogram">Chattogram</option>
                     
                        <option value="Coxsbazar">Coxsbazar</option>
                     
                        <option value="Khagrachhari">Khagrachhari</option>
                     
                        <option value="Bandarban">Bandarban</option>
                     
                        <option value="Sirajganj">Sirajganj</option>
                     
                        <option value="Pabna">Pabna</option>
                     
                        <option value="Bogura">Bogura</option>
                     
                        <option value="Rajshahi">Rajshahi</option>
                     
                        <option value="Natore">Natore</option>
                     
                        <option value="Joypurhat">Joypurhat</option>
                     
                        <option value="Chapainawabganj">Chapainawabganj</option>
                     
                        <option value="Naogaon">Naogaon</option>
                     
                        <option value="Jashore">Jashore</option>
                     
                        <option value="Satkhira">Satkhira</option>
                     
                        <option value="Meherpur">Meherpur</option>
                     
                        <option value="Narail">Narail</option>
                     
                        <option value="Chuadanga">Chuadanga</option>
                     
                        <option value="Kushtia">Kushtia</option>
                     
                        <option value="Magura">Magura</option>
                     
                        <option value="Khulna">Khulna</option>
                     
                        <option value="Bagerhat">Bagerhat</option>
                     
                        <option value="Jhenaidah">Jhenaidah</option>
                     
                        <option value="Jhalakathi">Jhalakathi</option>
                     
                        <option value="Patuakhali">Patuakhali</option>
                     
                        <option value="Pirojpur">Pirojpur</option>
                     
                        <option value="Barisal">Barisal</option>
                     
                        <option value="Bhola">Bhola</option>
                     
                        <option value="Barguna">Barguna</option>
                     
                        <option value="Sylhet">Sylhet</option>
                     
                        <option value="Moulvibazar">Moulvibazar</option>
                     
                        <option value="Habiganj">Habiganj</option>
                     
                        <option value="Sunamganj">Sunamganj</option>
                     
                        <option value="Narsingdi">Narsingdi</option>
                     
                        <option value="Gazipur">Gazipur</option>
                     
                        <option value="Shariatpur">Shariatpur</option>
                     
                        <option value="Narayanganj">Narayanganj</option>
                     
                        <option value="Tangail">Tangail</option>
                     
                        <option value="Kishoreganj">Kishoreganj</option>
                     
                        <option value="Manikganj">Manikganj</option>
                     
                        <option value="Dhaka">Dhaka</option>
                     
                        <option value="Munshiganj">Munshiganj</option>
                     
                        <option value="Rajbari">Rajbari</option>
                     
                        <option value="Madaripur">Madaripur</option>
                     
                        <option value="Gopalganj">Gopalganj</option>
                     
                        <option value="Faridpur">Faridpur</option>
                     
                        <option value="Panchagarh">Panchagarh</option>
                     
                        <option value="Dinajpur">Dinajpur</option>
                     
                        <option value="Lalmonirhat">Lalmonirhat</option>
                     
                        <option value="Nilphamari">Nilphamari</option>
                     
                        <option value="Gaibandha">Gaibandha</option>
                     
                        <option value="Thakurgaon">Thakurgaon</option>
                     
                        <option value="Rangpur">Rangpur</option>
                     
                        <option value="Kurigram">Kurigram</option>
                     
                        <option value="Sherpur">Sherpur</option>
                     
                        <option value="Mymensingh">Mymensingh</option>
                     
                        <option value="Jamalpur">Jamalpur</option>
                     
                        <option value="Netrokona">Netrokona</option>
                     </select>
                </div>
                <div class="form-group col-6">
                    <select name="upazila" id="upazila" class="custom-select upazila" required="">
                      <option selected disabled>Select Upazila</option>
                     </select>
                </div>
              </div>
              <div class="form-group">
                  <textarea class="form-control" name="description" rows="3" placeholder="Say Something about this Book" required=""></textarea>
              </div>
            
              <div class="col-12 d-flex justify-content-center">
                  <button type="submit" class="btn btn-success btn-sm" name="donate_book">Submit</button>
              </div>
          </form>

      </div>
      </div>
    
    </div>
  </div>
</div>
{% else %} 
 <!-- login modal -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-side modal-bottom-right modal-notify modal-danger" role="document">
        <!--Content-->
        <div class="modal-content panel-warning">
            <!--Header-->
            <div class="Modal_header modal-header panel-heading bg-success text-light">
                <h5 class="modal-title text-center" id="">Login</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="white-text">×</span>
                </button>
            </div>

            <!--Body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-10 col-sm-10 col-10 offset-1 offset-sm-1 offset-md-1 justify-content-center">
                        <form id="loginForm" action="" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                           <div class="form-group loginErrorMsg">
                            
                           </div>
                            <div class="form-group">
                                <input placeholder="Enter Email" id="loginEmail" type="text" class="form-control " name="email" value="" required="" autocomplete="email" autofocus="">
                                                            </div>

                            <div class="login_P_txt form-group">
                                <input type="password" class="form-control" id="loginPassword" name="password" placeholder="Password" required="">

                                <a href="#">
                                    Forgot Password
                                </a>
                                
                            </div>
                            <div class="d-flex justify-content-center form-group">
                                <button type="submit" class=" btn btn-success btn-sm" name="login">Submit</button>
                            </div>
                        </form>
                        <div class="create_here_txt text-center">
                            <p>Don't have an account?
                                <a href="#" data-toggle="modal" data-target="#SignupModal" data-dismiss="modal">
                                    Create One Here
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <!--Footer-->
            <div class="modal-footer justify-content-center">
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-6 text-left">
                        <button type="button" class="btn btn-outline-danger">Facebook</button>
                    </div>
                    <div class="col-md-6 col-sm-6 col-6 text-right">
                        <button type="button" class="btn btn-danger">Google</button>
                    </div>
                </div>
            </div>
        </div>
        <!--/.Content-->
    </div>
  </div>






  <!-- sign-up modal  -->
  <div class="modal fade" id="signUpModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-side modal-bottom-right modal-notify modal-danger" role="document">
        <!--Content-->
        <div class="modal-content panel-warning">
            <!--Header-->
            <div class="modal-header panel-heading text-light bg-success">
                <h5 class="modal-title text-center" id="">Sign Up</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="white-text">×</span>
                </button>
            </div>

            <!--Body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-10 col-sm-10 col-10 0ffset-1 offset-sm-1 offset-md-1 justify-content-center">
                        <form id="signUpForm" action="" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="form-group signErrorMsg"></div>
                                            <div class="form-group">
                                <input placeholder="Enter Full Name" id="full_name" type="text" class="form-control " name="name" value="" required="" autocomplete="name" autofocus="">
                                                            </div>

                            <div class="form-group">
                                <input placeholder="Username" id="username" type="text" class="form-control " name="username" value="" required="" autocomplete="username" autofocus="" minlength="5">
                                                            </div>

                            <div class="form-group">
                                <input placeholder="Enter Email" id="signUpemail" type="email" class="form-control " name="email" value="" required="" autocomplete="email" autofocus="">
                                                            </div>


                            <div class="form-group">
                                <input placeholder="Enter Password" id="signUppassword" type="password" class="form-control " name="password" value="" required="" autofocus="">
                                                            </div>


                            <div class="form-group">
                                <input placeholder="Confirm Password" id="confirm_password" type="password" class="form-control " name="confirm_password" value="" required="" autofocus="">
                                                            </div>

                            <div class="col-12 d-flex justify-content-center">
                                <button type="submit" class=" btn btn-success" name="login">Submit</button>
                            </div>
                        </form>
                        <div class="create_here_txt text-center">
                            <p>Already have and account?
                                <a href="#" data-toggle="modal" data-target="#LoginModal" data-dismiss="modal">
                                    Login Here
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <!--Footer-->
            <div class="modal-footer justify-content-center">
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-6 text-left">
                        <button type="button" class="btn btn-outline-danger">Facebook</button>
                    </div>
                    <div class="col-md-6 col-sm-6 col-6 text-right">
                        <button type="button" class="btn btn-danger">Google</button>
                    </div>
                </div>
            </div>
        </div>
        <!--/.Content-->
    </div>
  </div>
{% endif %}





     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
     {% block js %}
     {% if not request.user.is_authenticated %}
       <script>
          
           let curr_url=window.location.href
           if(curr_url.split("?")[1]){
            document.getElementById('loginBtn').click();
              
           };
            $("#loginForm").on("submit",function(e){
                e.preventDefault()
               let email=$("#loginEmail").val()
               let password=$("#loginPassword").val()
               let csrf=$("input[name='csrfmiddlewaretoken']").val()
               $.ajax({
                url:"{% url 'login' %}",
                method:"POST",
                data:{csrfmiddlewaretoken:csrf,email:email,password:password},
                success:function(res){
                  
                   if(res.success){
                    console.log("ok")
                      window.location.href="/dashboard"
                   }else{
                       $(".loginErrorMsg").html(`
                         <p style="color:red">${res.error}</p>
                        `)
                   }
                }
               })
            })
       </script>



<script>
    $("#signUpForm").on("submit",function(e){
        e.preventDefault()
       let csrf=$("input[name='csrfmiddlewaretoken']").val()

        let full_name=$("#full_name").val()
       let username=$("#username").val()
       let email=$("#signUpemail").val()
       
       let password=$("#signUppassword").val()
       let confirmPassword=$("#confirm_password").val()
    
       if(confirmPassword==password){
            $.ajax({
            url:"{% url 'signup' %}",
            method:"POST",
            data:{csrfmiddlewaretoken:csrf,
                full_name:full_name,
                username:username
                ,email:email,
                password:password},
            success:function(res){
             console.log(res)
            if(res.success){
             
                window.location.href="/dashboard"
            }else{
                $(".signErrorMsg").html(`
                    <p style="color:red">${res.error}</p>
                    `)
            }
            }
        });
       }else{
        $(".signErrorMsg").html(`
                 <p style="color:red">Doesn't match confirm password</p>
                `)
       }
      
    })
</script>
     {% endif %}
     
     {% endblock %}
    </body>
</html>